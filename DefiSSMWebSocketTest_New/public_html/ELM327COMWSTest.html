<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>ELM327COM WebSocket Test</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width">
        <script src="js/libs/jquery/jquery.js"></script>
        <script src="js/SSMCOM_WSTest.js"></script>
        <script>
            var ssm_ws = new SSMCOM_Websocket();
            ssm_ws.ModePrefix = "ELM327";
            ssm_ws.onVALpacketReceived = function(val)
            {
                //clear
                $('#div_val_data').html("");
                for (var key in val)
                {
                    $('#div_val_data').append(key + " : " + val[key] + "<br>" );
                }
            };
            ssm_ws.onERRpacketReceived = function(msg)
            {
                $('#div_err_data').append(msg + "<br>");
            };
            ssm_ws.onRESpacketReceived = function(msg)
            {
                $('#div_res_data').append(msg + "<br>");
            };
            ssm_ws.onWebsocketError = function(msg)
            {
                $('#div_ws_message').append(msg + "<br>");
            };
            ssm_ws.onWebsocketOpen = function()
            {
                $('#div_ws_message').append('* Connection open<br/>');

                $('#sendmessagecontent_box').removeAttr("disabled");
                $('#sendButton').removeAttr("disabled");
                $('#connectButton').attr("disabled", "disabled");
                $('#disconnectButton').removeAttr("disabled");  
            };
            ssm_ws.onWebsocketClose = function()
            {
                $('#div_ws_message').append('* Connection closed<br/>');
                
                $('#sendmessagecontent_box').attr("disabled", "disabled");
                $('#sendButton').attr("disabled", "disabled");
                $('#connectButton').removeAttr("disabled");
                $('#disconnectButton').attr("disabled", "disabled");
            };
            
            function connectWebSocket()
            {
                ssm_ws.URL = $("#serverURL_box").val();
                ssm_ws.Connect();
            };
            
            function disconnectWebSocket()
            {
                ssm_ws.Close();
            };
            
            function input_SSM_COM_READ()
            {
                ssm_ws.SendSSMCOMRead($('#ssmcomcode_select').val(), $('#ssmcode_readmode').val(), $('#ssmcode_flag').val());
            };
            
            function input_SSMCOM_SLOWREAD_INTERVAL()
            {
                ssm_ws.SendSSMSlowreadInterval($('#interval_SSMCOM_SLOWREAD_INTERVAL').val());
            };
        </script>
    </head>
    <body>
        <div><h2>DefiSSMCOM WebSocket Test</h2></div>
        <hr>
        Server URL : <input type="text" required="required" id="serverURL_box" /> 
         <input type="button" id="connectButton" value="Connect" onclick="connectWebSocket()"/>
         <input type="button" id="disconnectButton" value="Disconnect" onclick="disconnectWebSocket()"/><br>
         <hr>
        
         <h4>ELM327_COM_READ</h4>
         <ul>
             <li>OBDIICode<br>
                <select id="ssmcomcode_select">
                    <option value="Engine_Load">Engine_Load</option>
                    <option value="Coolant_Temperature">Coolant_Temperature</option>
                    <option value="Air_Fuel_Correction_1">Air_Fuel_Correction_1</option>
                    <option value="Air_Fuel_Learning_1">Air_Fuel_Learning_1</option>
                    <option value="Air_Fuel_Correction_2">Air_Fuel_Correction_2</option>
                    <option value="Air_Fuel_Learning_2">Air_Fuel_Learning_2</option>
                    <option value="Fuel_Tank_Pressure">Fuel_Tank_Pressure</option>
                    <option value="Manifold_Absolute_Pressure">Manifold_Absolute_Pressure</option>
                    <option value="Engine_Speed">Engine_Speed</option>
                    <option value="Vehicle_Speed">Vehicle_Speed</option>
                    <option value="Ignition_Timing">Ignition_Timing</option>
                    <option value="Intake_Air_Temperature">Intake_Air_Temperature</option>
                    <option value="Mass_Air_Flow">Mass_Air_Flow</option>
                    <option value="Throttle_Opening_Angle">Throttle_Opening_Angle</option>
                    <option value="Run_time_since_engine_start">Run_time_since_engine_start</option>
                    <option value="Distance_traveled_with_MIL_on">Distance_traveled_with_MIL_on</option>
                    <option value="Fuel_Rail_Pressure">Fuel_Rail_Pressure</option>
                    <option value="Fuel_Rail_Pressure_diesel">Fuel_Rail_Pressure_diesel</option>
                    <option value="Commanded_EGR">Commanded_EGR</option>
                    <option value="EGR_Error">EGR_Error</option>
                    <option value="Commanded_evaporative_purge">Commanded_evaporative_purge</option>
                    <option value="Fuel_Level_Input">Fuel_Level_Input</option>
                    <option value="Number_of_warmups_since_codes_cleared">Number_of_warmups_since_codes_cleared</option>
                    <option value="Distance_traveled_since_codes_cleared">Distance_traveled_since_codes_cleared</option>
                    <option value="Evap_System_Vapor_Pressure">Evap_System_Vapor_Pressure</option>
                    <option value="Atmospheric_Pressure">Atmospheric_Pressure</option>
                    <option value="Catalyst_TemperatureBank_1_Sensor_1">Catalyst_TemperatureBank_1_Sensor_1</option>
                    <option value="Catalyst_TemperatureBank_2_Sensor_1">Catalyst_TemperatureBank_2_Sensor_1</option>
                    <option value="Catalyst_TemperatureBank_1_Sensor_2">Catalyst_TemperatureBank_1_Sensor_2</option>
                    <option value="Catalyst_TemperatureBank_2_Sensor_2">Catalyst_TemperatureBank_2_Sensor_2</option>
                    <option value="Battery_Voltage">Battery_Voltage</option>
                    <option value="Absolute_load_value">Absolute_load_value</option>
                    <option value="Command_equivalence_ratio">Command_equivalence_ratio</option>
                    <option value="Relative_throttle_position">Relative_throttle_position</option>
                    <option value="Ambient_air_temperature">Ambient_air_temperature</option>
                    <option value="Absolute_throttle_position_B">Absolute_throttle_position_B</option>
                    <option value="Absolute_throttle_position_C">Absolute_throttle_position_C</option>
                    <option value="Accelerator_pedal_position_D">Accelerator_pedal_position_D</option>
                    <option value="Accelerator_pedal_position_E">Accelerator_pedal_position_E</option>
                    <option value="Accelerator_pedal_position_F">Accelerator_pedal_position_F</option>
                    <option value="Commanded_throttle_actuator">Commanded_throttle_actuator</option>
                    <option value="Time_run_with_MIL_on">Time_run_with_MIL_on</option>
                    <option value="Time_since_trouble_codes_cleared">Time_since_trouble_codes_cleared</option>
                    <option value="Ethanol_fuel_percent">Ethanol_fuel_percent</option>
                </select>
             </li>
             <li>Read_mode<br>
                <select id="ssmcode_readmode">
                    <option value="FAST">FAST</option>
                    <option value="SLOW">SLOW</option>
                </select>
             </li>
             <li>Flag<br>
                <select id="ssmcode_flag">
                    <option value="true">true</option>
                    <option value="false">false</option>
                </select>
             </li>
             <li>
                 <input type="button" id="button_SSM_COM_READ" value="input SSM_COM_READ" onclick="input_SSM_COM_READ()"/>
             </li>
         </ul>
         
        <h4>SSMCOM_SLOWREAD_INTERVAL</h4>
         <ul>
             <li>
                <input type="number"  id="interval_SSMCOM_SLOWREAD_INTERVAL">
             </li>
            <li>
                 <input type="button" id="button_SSMCOM_SLOWREAD_INTERVAL" value="input SSMCOM_SLOWREAD_INTERVAL" onclick="input_SSMCOM_SLOWREAD_INTERVAL()"/>
             </li>
         </ul>
                  
         <hr>
         
         <h3>VAL packet</h3>
         <div id="div_val_data"></div>
         <hr>
         <h3>ERR packet</h3>
         <div id="div_err_data"></div>
         <hr>
         <h3>RES packet</h3>
         <div id="div_res_data"></div>
         <hr>
         <h3>Websocket message</h3>
         <div id="div_ws_message"></div>
         <hr>
    </body>
</html>